---
layout: single
title: "Javascript - 면접스터디_실행컨텍스트, 클로저"
categories: Javascript
tag: Javascript
toc: true
author_profile: false
sidebar:
  nav: "docs"
---
# 실행 컨텍스트, 클로저

## [실행 컨텍스트 🔥](https://github.com/junh0328/prepare_frontend_interview/blob/main/js.md#%EC%8B%A4%ED%96%89-%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8)

### 실행 컨텍스트에 대해 말해보세요 🔥🔥

- 소스코드를 실행하는데 필요한 환경을 제공하고 코드의 실행 결과를 실제 관리 하는 영역.
    >✍🏻 소스코드란? ⇒ 실행 가능한 코드(just  실행가능한 또는 컴퓨터가 읽을 수 있는 코드)
    
- JS 는 소스코드를 평가해서 **실행 컨텍스트**를 생성하게 된다.
- 실행 컨텍스트가 생성되기전 소스코드의 **평가(또는 생성)단계**와 **실행 단계 과정이** 구분된다.
    >✍🏻 소스코드 평가(생성) = ‘선언문’<br>
    소스코드 실행 = ‘선언문 이외의 문’ 처리된다.
    
    ```javascript
    var = x; // 선언문 -> 평가, x = undefined
    x = 1; // 할당문 -> 실행
    
    // 1을 할당할 때 x 변수가 실행 컨텍스트가 관리하는 스코프에 등록되어있는지 확인한다. (선언되었는지 확인)
    // 선언된 변수라고 판단되면, 1 이라는 값을 x에 할당하게 되고 실행컨텍스트에 등록되어 관리한다.
    ```
    
- 실행 컨텍스트 구분 (렉시컬 환경, 콜 스택)
    1. 식별자와 식별자에 바인딩 된 값을 관리하는 **환경 레코드**와 **외부 렉시컬 환경에 대한 참조**(상위 스코프에 대한 참조를 기록)로 구분된다. 이를 하나의 컴포넌트, **렉시컬 환경** 이라고 한다.
        > ***환경 레코드 + 외부 렉시컬 환경에 대한 참조를 기록하는 자료구조 = 렉시컬 환경***

    2. 환경 레코드는 식별자 등록과 식별자에 바인딩된 값(value)을 관리하는 저장소
    3. 외부 렉시컬 환경에 대한 참조는 자료구조를 뜻하며 에서는 **스코프체인을 구현**한다.
        
        > ***스코프 체인***<br>
        현재 활성화된 실행 컨텍스트에 참조할 수 있는 데이터가 없다면 상위 스코프를  탐색, 검색해 **식별자 결정**을 돕는다.
    4. 코드 실행 순서 관리 하는 **call Stack** 
        ```javascript
        const x = 1
        
        function foo() {
          const y = 2;
        	
        	function bar() {
        		const z = 3;
        		console.log(x + y + z);
        	}
        	bar();
        }
        
        foo();
        ```
        
        `콜스텍 실행순서` 
        
        1.cost z=3, console.log(x + y + z)
        
        ---
        
        2.bar 함수 실행 컨텍스트 생성 → const z, bar 함수 내부 
        
        ---
        
        3.const y, bar 함수 선언
        
        ---
        
        4.foo 함수 실행 컨텍스트 생성→ foo 함수 내부
        
        ---
        
        5.전역 실행 컨텍스트 생성 → const x, foo 함수 선언 
        
        ---
        
    5. 렉시컬 환경 + call Stack = 실행 컨텍스트
    
- 실행 컨텍스트 정리
    
    >🔥 **실행 컨텍스트 정리**<br>
    : 소스 코드를 실행하는데 필요한 환경을 제공하고 코드의 실행결과를 관리하는 영역이다.<br><br>
    **실행 컨텍스트**는 **식별자를 등록과 식별자에 값을 바인딩** 하는 역할과 **스코프 체인을 구현하여 실행 컨 텍스트간의 연결을 통해 식별자 결정**을 진행하고 **callStack**으로 **코드 실행 순서를 관리 한다.**
    

## [클로저 🔥](https://github.com/junh0328/prepare_frontend_interview/blob/main/js.md#%ED%81%B4%EB%A1%9C%EC%A0%80)

### 클로저에 대해서 아나요? 🔥🔥

- 먼저 렉시컬 스코프를 이해가 필요하다.
    - 렉시컬 스코프란 자바스크립트 엔진은 함수를 어디에 정의 했는지에 따라 상위스코프를 결정하는데 이러한 행위(?)를 렉시컬 스코프라 한다.
    - 렉시컬 스코프는**`함수 객체의 내부 슬롯`**에 자신이 정의된 환경(상위 스코프로서 참조)을 저장한다.
    - 실행 컨텍스트 개념으로 돌아가 다시 이해 해보자면 렉시컬 환경에는 `**‘외부 렉시컬 환경에 대한 참조’**`가 있는데 이는 상위 스코프를 참조하고 기록하게 된다. 그 상위 스코프 참조를 누가 전해주냐?
    함수 객체의 내부 슬롯이 전해준다.
        1. **`어떤함수`**가 호출되면, **`어떤함수`**의 렉시컬 환경이 생성되고 **`어떤함수`**가 **`선언된 렉시컬 환경`**을  **`함수 객체의 내부 슬롯`**에  저장한다.
        2. **`선언된 렉시컬 환경`**을 상위 스코프로서 참조할 수 있도록 
        **`어떤함수`**의 렉시컬 환경의 **`외부 렉시컬 환경에 대한 참조`**에 할당 한다.
    - 이처럼 중첩함수가 외부함수의 식별자를 참조할 수 있을 수 있는 이유는 함수 객체의 내부 슬롯에 상위 스코프를 참조할 수 있도록 저장하고 있기 때문이며,
    - 중첩함수가 **외부 함수보다 생명주기가 길고** 외부함수의 생명주기가 끝난 이후에도 **외부함수의 식별자를 참조하고 변경할 수 있다면** 이러한 중첩함수를 클로져 라고 칭한다.
    - 이렇게 클로저에 의해 참조되고 있는 상위 스코프의 식별자를 자유변수라고 부르며, 자유변수에 묶여있는 함수 를 클로저 라고도 얘기 한다.

### 클로저를 사용하면 뭐가 좋죠? 🔥

- 클로저는 상태를 안전하게 변경하고 유지하기 위해 사용한다.
- 상태를 의도치 않게 변경되지 않도록 상태를 안전하게 은닉하고 특정한 함수에게만 상태 변경을 허용 하기 위해 사용된다.

### 클로저를 어떻게 생성하나요? 🔥

- 함수 내부에 함수를 선언하고 함수내부에 선언된 함수를 중첩함수.
중첩함수 외부에 있는 함수를 외부 함수. 라고할 때
- 중첩함수는 외부 함수의 식별자를 참조하고 외부 함수보다 생명주기가 길어서 외부함수의 생명주기가 끝나고도 중첩함수를 통해 외부함수의 식별자를 참조하고 있는 데이터를 사용하거나 변경할 수 있는 상태의 중첩함수를 생성해주면 된다.